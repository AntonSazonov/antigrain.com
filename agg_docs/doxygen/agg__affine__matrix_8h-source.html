<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>agg_affine_matrix.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>agg_affine_matrix.h</h1><a href="agg__affine__matrix_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//----------------------------------------------------------------------------</font>
00002 <font class="comment">// Anti-Grain Geometry - Version 2.0 </font>
00003 <font class="comment">// Copyright (C) 2002 Maxim Shemanarev (McSeem)</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// Permission to copy, use, modify, sell and distribute this software </font>
00006 <font class="comment">// is granted provided this copyright notice appears in all copies. </font>
00007 <font class="comment">// This software is provided "as is" without express or implied</font>
00008 <font class="comment">// warranty, and with no claim as to its suitability for any purpose.</font>
00009 <font class="comment">//</font>
00010 <font class="comment">//----------------------------------------------------------------------------</font>
00011 <font class="comment">// Contact: mcseem@antigrain.com</font>
00012 <font class="comment">//          mcseemagg@yahoo.com</font>
00013 <font class="comment">//          http://www.antigrain.com</font>
00014 <font class="comment">//----------------------------------------------------------------------------</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// Affine transformation classes.</font>
00017 <font class="comment">//</font>
00018 <font class="comment">//----------------------------------------------------------------------------</font>
00019 <font class="preprocessor">#ifndef AGG_AFFINE_MATRIX_INCLUDED</font>
00020 <font class="preprocessor"></font><font class="preprocessor">#define AGG_AFFINE_MATRIX_INCLUDED</font>
00021 <font class="preprocessor"></font>
00022 <font class="preprocessor">#include &lt;math.h&gt;</font>
00023 
00024 <font class="keyword">namespace </font>agg
00025 {
00026 
00027     <font class="comment">//========================================================================</font>
00028     <font class="comment">//</font>
00029     <font class="comment">// Introduction to Affine Transformations and Matrices</font>
00030     <font class="comment">//</font>
00031     <font class="comment">// Affine transformation are linear transformations in Cartesian coordinates</font>
00032     <font class="comment">// (strictly speaking not only in Cartesian, but for the beginning we will </font>
00033     <font class="comment">// think so). They are rotation, scaling, translation and skewing.  </font>
00034     <font class="comment">// After any affine transformation a line segment remains a line segment </font>
00035     <font class="comment">// and it will never become a curve. </font>
00036     <font class="comment">//</font>
00037     <font class="comment">// There will be no math about matrix calculations, since it has been </font>
00038     <font class="comment">// described many times. Ask yourself a very simple question:</font>
00039     <font class="comment">// "why do we need to understand and use some matrix stuff instead of just </font>
00040     <font class="comment">// rotating, scaling and so on". The answers are:</font>
00041     <font class="comment">//</font>
00042     <font class="comment">// 1. Any combination of transformations can be done by only 4 multiplications</font>
00043     <font class="comment">//    and 4 additions in floating point.</font>
00044     <font class="comment">// </font>
00045     <font class="comment">// 2. One matrix transformation is equivalent to the number of consecutive</font>
00046     <font class="comment">//    discrete transformations, i.e. the matrix "accumulates" all transformations </font>
00047     <font class="comment">//    in the order of their settings. Suppose we have 4 transformations: </font>
00048     <font class="comment">//       - rotate by 30 degrees,</font>
00049     <font class="comment">//       - scale X to 2.0, </font>
00050     <font class="comment">//       - scale Y to 1.5, </font>
00051     <font class="comment">//       - move to (100, 100). </font>
00052     <font class="comment">//    The result will depend on the order of these transformations, </font>
00053     <font class="comment">//    and the advantage of matrix is that the sequence of discret calls:</font>
00054     <font class="comment">//    rotate(30), scaleX(2.0), scaleY(1.5), move(100,100) </font>
00055     <font class="comment">//    will have exactly the same result as the following matrix transformations:</font>
00056     <font class="comment">//   </font>
00057     <font class="comment">//    matrix m;</font>
00058     <font class="comment">//    m *= rotate_matrix(30); </font>
00059     <font class="comment">//    m *= scaleX_matrix(2.0);</font>
00060     <font class="comment">//    m *= scaleY_matrix(1.5);</font>
00061     <font class="comment">//    m *= move_matrix(100,100);</font>
00062     <font class="comment">//</font>
00063     <font class="comment">//    m.transform_my_point_at_last(x, y);</font>
00064     <font class="comment">//</font>
00065     <font class="comment">// What is the good of it? In real life we will set-up the matrix only once</font>
00066     <font class="comment">// and then transform many points, let alone the convenience to set any </font>
00067     <font class="comment">// combination of transformations.</font>
00068     <font class="comment">//</font>
00069     <font class="comment">// So, how to use it? Very easy - literally as it's shown above. Not quite,</font>
00070     <font class="comment">// let us write a correct example:</font>
00071     <font class="comment">//</font>
00072     <font class="comment">// agg::affine_matrix m;</font>
00073     <font class="comment">// m *= agg::rotation_matrix(30.0 * 3.1415926 / 180.0);</font>
00074     <font class="comment">// m *= agg::scaling_matrix(2.0, 1.5);</font>
00075     <font class="comment">// m *= agg::translation_matrix(100.0, 100.0);</font>
00076     <font class="comment">// m.transform(&amp;x, &amp;y);</font>
00077     <font class="comment">//</font>
00078     <font class="comment">// The affine matrix is all you need to perform any linear transformation,</font>
00079     <font class="comment">// but all transformations have origin point (0,0). It means that we need to </font>
00080     <font class="comment">// use 2 translations if we want to rotate someting around (100,100):</font>
00081     <font class="comment">// </font>
00082     <font class="comment">// m *= agg::translation_matrix(-100.0, -100.0);         // move to (0,0)</font>
00083     <font class="comment">// m *= agg::rotation_matrix(30.0 * 3.1415926 / 180.0);  // rotate</font>
00084     <font class="comment">// m *= agg::translation_matrix(100.0, 100.0);           // move back to (100,100)</font>
00085     <font class="comment">// </font>
00086     <font class="comment">// In order to make your life easier there's method center_transform()</font>
00087     <font class="comment">// which treats a given point as a center of all transformations. This</font>
00088     <font class="comment">// point can be set with set_center(x, y). However, it requires 4 extra </font>
00089     <font class="comment">// add operations, and so, less effective. The center point is an extra</font>
00090     <font class="comment">// feature, it is not considered in matrix multiplication, assignments,</font>
00091     <font class="comment">// loading/storing and so on. In AGG the basic function transform() is</font>
00092     <font class="comment">// used everywhere.</font>
00093     <font class="comment">// </font>
<a name="l00094"></a><a class="code" href="classagg_1_1affine__matrix.html">00094</a>     <font class="keyword">class </font>affine_matrix
00095     {
00096     <font class="keyword">public</font>:
00097         <font class="comment">//========================================== Construction</font>
00098         <font class="comment">// Construct a matrix of identity - it does not transform anything</font>
<a name="l00099"></a><a class="code" href="classagg_1_1affine__matrix.html#a0">00099</a>         <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>() :
00100           <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>(1.0), <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>(1.0), <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>(0.0), 
00101           <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>(0.0)
00102         {}
00103 
00104         <font class="comment">// Copy-constructor</font>
<a name="l00105"></a><a class="code" href="classagg_1_1affine__matrix.html#a1">00105</a>         <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(<font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; m) :
00106           <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>), <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>), <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>), <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>), <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>), <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>(m.<a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>),
00107           <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>(0.0)
00108         {}
00109 
00110         <font class="comment">// Construct a custom matrix. Usually used in derived classes</font>
<a name="l00111"></a><a class="code" href="classagg_1_1affine__matrix.html#a2">00111</a>         <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(<font class="keywordtype">double</font> v0, <font class="keywordtype">double</font> v1, <font class="keywordtype">double</font> v2, <font class="keywordtype">double</font> v3, <font class="keywordtype">double</font> v4, <font class="keywordtype">double</font> v5) :
00112           <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>(v0), <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>(v1), <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>(v2), <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>(v3), <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>(v4), <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>(v5),
00113           <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>(0.0), <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>(0.0)
00114         {}
00115 
00116         <font class="comment">//========================================== Operations</font>
00117         <font class="comment">// Reset - actually load identity matrix</font>
00118         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a3">reset</a>();
00119 
00120         <font class="comment">// Multiply matrix to another one</font>
00121         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a4">multiply</a>(<font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; m);
00122 
00123         <font class="comment">// Invert matrix. Do not try to invert degenerate matrices, </font>
00124         <font class="comment">// there's no check for validity. If you set scale to 0 and </font>
00125         <font class="comment">// then try to invert matrix, expect unpredictable result.</font>
00126         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a5">invert</a>();
00127 
00128         <font class="comment">// Mirroring around X</font>
00129         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a6">flip_x</a>();
00130 
00131         <font class="comment">// Mirroring around Y</font>
00132         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a7">flip_y</a>();
00133 
00134         <font class="comment">//=========================================== Load/Store</font>
00135         <font class="comment">// Store matrix to an array [6] of double</font>
<a name="l00136"></a><a class="code" href="classagg_1_1affine__matrix.html#a8">00136</a>         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a8">store_to</a>(<font class="keywordtype">double</font>* m)<font class="keyword"> const</font>
00137 <font class="keyword">        </font>{
00138             *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>; *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>; *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>; *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>; *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>; *m++ = <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>;
00139         }
00140 
00141         <font class="comment">// Load matrix from an array [6] of double</font>
<a name="l00142"></a><a class="code" href="classagg_1_1affine__matrix.html#a9">00142</a>         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a9">load_from</a>(<font class="keyword">const</font> <font class="keywordtype">double</font>* m)
00143         {
00144             <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> = *m++; <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> = *m++; <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a> = *m++; <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> = *m++; <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a> = *m++;  <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a> = *m++;
00145             <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00146         }
00147 
00148         <font class="comment">//=========================================== Operators</font>
00149         <font class="comment">// Assignment</font>
<a name="l00150"></a><a class="code" href="classagg_1_1affine__matrix.html#a10">00150</a>         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a10">operator = </a>(<font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; m)
00151         {
00152             <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> = m.m0; <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> = m.m1; <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a> = m.m2; <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> = m.m3; <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a> = m.m4; <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a> = m.m5;
00153             <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00154         }
00155 
00156         <font class="comment">// Load matrix from an array [6] of double</font>
<a name="l00157"></a><a class="code" href="classagg_1_1affine__matrix.html#a11">00157</a>         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a10">operator = </a>(<font class="keyword">const</font> <font class="keywordtype">double</font>* m)
00158         {
00159             <font class="keywordflow">return</font> <a class="code" href="classagg_1_1affine__matrix.html#a9">load_from</a>(m);
00160         }
00161 
00162         <font class="comment">// Multiply current matrix to another one</font>
<a name="l00163"></a><a class="code" href="classagg_1_1affine__matrix.html#a12">00163</a>         <font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; <a class="code" href="classagg_1_1affine__matrix.html#a12">operator *= </a>(<font class="keyword">const</font> <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>&amp; m)
00164         {
00165             <font class="keywordflow">return</font> <a class="code" href="classagg_1_1affine__matrix.html#a4">multiply</a>(m);
00166         }
00167 
00168         <font class="comment">//============================================ Transformations</font>
00169         <font class="comment">// Direct transformation x and y</font>
00170         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a13">transform</a>(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y) <font class="keyword">const</font>;
00171 
00172         <font class="comment">// Direct transformation x and y with explicit center</font>
00173         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a14">center_transform</a>(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y) <font class="keyword">const</font>;
00174 
00175         <font class="comment">// Inverse transformation x and y. Works slower than direct transformation,</font>
00176         <font class="comment">// so if the performance is critical it's better to invert() the matrix</font>
00177         <font class="comment">// and then use transform()</font>
00178         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a15">inverse_transform</a>(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y) <font class="keyword">const</font>;
00179 
00180         <font class="comment">// Inverse transformation x and y with explicit center</font>
00181         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a16">center_inverse_transform</a>(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y) <font class="keyword">const</font>;
00182 
00183         <font class="comment">//============================================ Auxiliary</font>
00184         <font class="comment">// Calculate determinant of matrix</font>
<a name="l00185"></a><a class="code" href="classagg_1_1affine__matrix.html#a17">00185</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#a17">determinant</a>()<font class="keyword"> const</font>
00186 <font class="keyword">        </font>{
00187             <font class="keywordflow">return</font> 1.0 / (<a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> * <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> - <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> * <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>);
00188         }
00189 
00190         <font class="comment">// Set transformation center</font>
<a name="l00191"></a><a class="code" href="classagg_1_1affine__matrix.html#a18">00191</a>         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1affine__matrix.html#a18">set_center</a>(<font class="keywordtype">double</font> cx, <font class="keywordtype">double</font> cy)
00192         {
00193             <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a> = cx; <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a> = cy;
00194         }
00195 
00196 
00197     <font class="keyword">private</font>:
<a name="l00198"></a><a class="code" href="classagg_1_1affine__matrix.html#o0">00198</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a>;
<a name="l00199"></a><a class="code" href="classagg_1_1affine__matrix.html#o1">00199</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>;
<a name="l00200"></a><a class="code" href="classagg_1_1affine__matrix.html#o2">00200</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>;
<a name="l00201"></a><a class="code" href="classagg_1_1affine__matrix.html#o3">00201</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a>;
<a name="l00202"></a><a class="code" href="classagg_1_1affine__matrix.html#o4">00202</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>;
<a name="l00203"></a><a class="code" href="classagg_1_1affine__matrix.html#o5">00203</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>;
<a name="l00204"></a><a class="code" href="classagg_1_1affine__matrix.html#o6">00204</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>;
<a name="l00205"></a><a class="code" href="classagg_1_1affine__matrix.html#o7">00205</a>         <font class="keywordtype">double</font> <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>;
00206     };
00207 
00208 
00209     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00210"></a><a class="code" href="classagg_1_1affine__matrix.html#a13">00210</a>     <font class="keyword">inline</font> <font class="keywordtype">void</font> affine_matrix::transform(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)<font class="keyword"> const</font>
00211 <font class="keyword">    </font>{
00212         <font class="keyword">register</font> <font class="keywordtype">double</font> tx = *x;
00213         *x = tx * <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> + *y * <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a> + <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>;
00214         *y = tx * <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> + *y * <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> + <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>;
00215     }
00216 
00217     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00218"></a><a class="code" href="classagg_1_1affine__matrix.html#a14">00218</a>     <font class="keyword">inline</font> <font class="keywordtype">void</font> affine_matrix::center_transform(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)<font class="keyword"> const</font>
00219 <font class="keyword">    </font>{
00220         <font class="keyword">register</font> <font class="keywordtype">double</font> tx = *x - <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>;
00221         <font class="keyword">register</font> <font class="keywordtype">double</font> ty = *y - <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>;
00222         *x = tx * <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> + ty * <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a> + <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a> + <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>;
00223         *y = tx * <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> + ty * <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> + <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a> + <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>;
00224     }
00225 
00226     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00227"></a><a class="code" href="classagg_1_1affine__matrix.html#a15">00227</a>     <font class="keyword">inline</font> <font class="keywordtype">void</font> affine_matrix::inverse_transform(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)<font class="keyword"> const</font>
00228 <font class="keyword">    </font>{
00229         <font class="keyword">register</font> <font class="keywordtype">double</font> d = <a class="code" href="classagg_1_1affine__matrix.html#a17">determinant</a>();
00230         <font class="keyword">register</font> <font class="keywordtype">double</font> a = (*x - <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a>) * d;
00231         <font class="keyword">register</font> <font class="keywordtype">double</font> b = (*y - <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a>) * d;
00232         *x = a * <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> - b * <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a>;
00233         *y = b * <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> - a * <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a>;
00234     }
00235 
00236     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00237"></a><a class="code" href="classagg_1_1affine__matrix.html#a16">00237</a>     <font class="keyword">inline</font> <font class="keywordtype">void</font> affine_matrix::center_inverse_transform(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)<font class="keyword"> const</font>
00238 <font class="keyword">    </font>{
00239         <font class="keyword">register</font> <font class="keywordtype">double</font> d = <a class="code" href="classagg_1_1affine__matrix.html#a17">determinant</a>();
00240         <font class="keyword">register</font> <font class="keywordtype">double</font> a = (*x - <a class="code" href="classagg_1_1affine__matrix.html#o4">m4</a> - <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>) * d;
00241         <font class="keyword">register</font> <font class="keywordtype">double</font> b = (*y - <a class="code" href="classagg_1_1affine__matrix.html#o5">m5</a> - <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>) * d;
00242         *x = a * <a class="code" href="classagg_1_1affine__matrix.html#o3">m3</a> - b * <a class="code" href="classagg_1_1affine__matrix.html#o2">m2</a> + <a class="code" href="classagg_1_1affine__matrix.html#o6">m_cx</a>;
00243         *y = b * <a class="code" href="classagg_1_1affine__matrix.html#o0">m0</a> - a * <a class="code" href="classagg_1_1affine__matrix.html#o1">m1</a> + <a class="code" href="classagg_1_1affine__matrix.html#o7">m_cy</a>;
00244     }
00245 
00246 
00247 
00248     <font class="comment">//========================================================================</font>
00249     <font class="comment">// Rotation matrix. sin() and cos() are calculated twice for the same angle.</font>
00250     <font class="comment">// There's no harm because the performance of sin()/cos() is very good on all</font>
00251     <font class="comment">// modern processors. Besides, this operation is not going to be invoked too </font>
00252     <font class="comment">// often.</font>
<a name="l00253"></a><a class="code" href="classagg_1_1rotation__matrix.html">00253</a>     <font class="keyword">class </font>rotation_matrix : <font class="keyword">public</font> affine_matrix
00254     {
00255     <font class="keyword">public</font>:
<a name="l00256"></a><a class="code" href="classagg_1_1rotation__matrix.html#a0">00256</a>         <a class="code" href="classagg_1_1rotation__matrix.html#a0">rotation_matrix</a>(<font class="keywordtype">double</font> a) : 
00257           <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(cos(a), sin(a), -sin(a), cos(a), 0.0, 0.0)
00258         {}
00259     };
00260 
00261     <font class="comment">//========================================================================</font>
00262     <font class="comment">// Scaling matrix. sx, sy - scale coefficients by X and Y respectively</font>
<a name="l00263"></a><a class="code" href="classagg_1_1scaling__matrix.html">00263</a>     <font class="keyword">class </font>scaling_matrix : <font class="keyword">public</font> affine_matrix
00264     {
00265     <font class="keyword">public</font>:
<a name="l00266"></a><a class="code" href="classagg_1_1scaling__matrix.html#a0">00266</a>         <a class="code" href="classagg_1_1scaling__matrix.html#a0">scaling_matrix</a>(<font class="keywordtype">double</font> sx, <font class="keywordtype">double</font> sy) : 
00267           <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(sx, 0.0, 0.0, sy, 0.0, 0.0)
00268         {}
00269     };
00270 
00271     <font class="comment">//========================================================================</font>
00272     <font class="comment">// Translation matrix</font>
<a name="l00273"></a><a class="code" href="classagg_1_1translation__matrix.html">00273</a>     <font class="keyword">class </font>translation_matrix : <font class="keyword">public</font> affine_matrix
00274     {
00275     <font class="keyword">public</font>:
<a name="l00276"></a><a class="code" href="classagg_1_1translation__matrix.html#a0">00276</a>         <a class="code" href="classagg_1_1translation__matrix.html#a0">translation_matrix</a>(<font class="keywordtype">double</font> tx, <font class="keywordtype">double</font> ty) : 
00277           <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(1.0, 0.0, 0.0, 1.0, tx, ty)
00278         {}
00279     };
00280 
00281     <font class="comment">//========================================================================</font>
00282     <font class="comment">// Sckewing (shear) matrix</font>
<a name="l00283"></a><a class="code" href="classagg_1_1skewing__matrix.html">00283</a>     <font class="keyword">class </font>skewing_matrix : <font class="keyword">public</font> affine_matrix
00284     {
00285     <font class="keyword">public</font>:
<a name="l00286"></a><a class="code" href="classagg_1_1skewing__matrix.html#a0">00286</a>         <a class="code" href="classagg_1_1skewing__matrix.html#a0">skewing_matrix</a>(<font class="keywordtype">double</font> sx, <font class="keywordtype">double</font> sy) : 
00287           <a class="code" href="classagg_1_1affine__matrix.html#a0">affine_matrix</a>(1.0, tan(sy), tan(sx), 1.0, 0.0, 0.0)
00288         {}
00289     };
00290 
00291 
00292 
00293 }
00294 
00295 
00296 <font class="preprocessor">#endif</font>
00297 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated on Tue Apr 23 09:06:33 2002 for AGG v2.0 beta by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
