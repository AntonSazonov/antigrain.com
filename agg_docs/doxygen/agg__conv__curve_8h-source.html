<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>agg_conv_curve.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>agg_conv_curve.h</h1><a href="agg__conv__curve_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//----------------------------------------------------------------------------</font>
00002 <font class="comment">// Anti-Grain Geometry - Version 2.0 </font>
00003 <font class="comment">// Copyright (C) 2002 Maxim Shemanarev (McSeem)</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// Permission to copy, use, modify, sell and distribute this software </font>
00006 <font class="comment">// is granted provided this copyright notice appears in all copies. </font>
00007 <font class="comment">// This software is provided "as is" without express or implied</font>
00008 <font class="comment">// warranty, and with no claim as to its suitability for any purpose.</font>
00009 <font class="comment">//</font>
00010 <font class="comment">//----------------------------------------------------------------------------</font>
00011 <font class="comment">// Contact: mcseem@antigrain.com</font>
00012 <font class="comment">//          mcseemagg@yahoo.com</font>
00013 <font class="comment">//          http://www.antigrain.com</font>
00014 <font class="comment">//----------------------------------------------------------------------------</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// classes conv_curve</font>
00017 <font class="comment">//</font>
00018 <font class="comment">//----------------------------------------------------------------------------</font>
00019 
00020 <font class="preprocessor">#ifndef AGG_CONV_CURVE_INCLUDED</font>
00021 <font class="preprocessor"></font><font class="preprocessor">#define AGG_CONV_CURVE_INCLUDED</font>
00022 <font class="preprocessor"></font>
00023 <font class="preprocessor">#include "<a class="code" href="agg__basics_8h.html">agg_basics.h</a>"</font>
00024 <font class="preprocessor">#include "<a class="code" href="agg__curves_8h.html">agg_curves.h</a>"</font>
00025 
00026 <font class="keyword">namespace </font>agg
00027 {
00028 
00029 
00030     <font class="comment">//------------------------------------------------------------------------</font>
00031     <font class="comment">// Curve converter class. Any path storage can have Bezier curves defined </font>
00032     <font class="comment">// by their control points. There're two types of curves supported: curve3 </font>
00033     <font class="comment">// and curve4. Curve3 is a conic Bezier curve with 2 endpoints and 1 control</font>
00034     <font class="comment">// point. Curve4 has 2 control points (4 points in total) and can be used</font>
00035     <font class="comment">// to interpolate more complicated curves. Curve4, unlike curve3 can be used </font>
00036     <font class="comment">// to approximate arcs, both curcular and elliptical. Curves are approximated </font>
00037     <font class="comment">// with straight lines and one of the approaches is just to store the whole </font>
00038     <font class="comment">// sequence of vertices that approximate our curve. It takes additional </font>
00039     <font class="comment">// memory, and at the same time the consecutive vertices can be calculated </font>
00040     <font class="comment">// on demand. </font>
00041     <font class="comment">//</font>
00042     <font class="comment">// Initially, path storages are not suppose to keep all the vertices of the</font>
00043     <font class="comment">// curves (although, nothig prevents us from doing so). Instead, path_storage</font>
00044     <font class="comment">// keeps only vertices, needed to calculate a curve on demand. Those vertices</font>
00045     <font class="comment">// are marked with special flag. So, if the path_storage contains curves </font>
00046     <font class="comment">// (which are not real curves yet), and we render this storage directly, </font>
00047     <font class="comment">// all we will see is only 2 or 3 straight line segments (for curve3 and </font>
00048     <font class="comment">// curve4 respectively). If we need to see real curves drawn we need to </font>
00049     <font class="comment">// include this class into the conversion pipeline. </font>
00050     <font class="comment">//</font>
00051     <font class="comment">// Class conv_curve recognizes flags pathflag_curve3 and pathflag_curve4 </font>
00052     <font class="comment">// and converts these vertices into a move_to() sequence. Template version </font>
00053     <font class="comment">// of the class can use custom curve interpolators, by default classes curve3 </font>
00054     <font class="comment">// and curve4 are used. All you need implement your own interpolators is </font>
00055     <font class="comment">// to support methods init(), reset() and next_vertex().</font>
00056     <font class="comment">//------------------------------------------------------------------------</font>
00057     <font class="keyword">template</font>&lt;<font class="keyword">class </font>VertexSource, 
00058              <font class="keyword">class </font>Curve3_Iterator=curve3,
<a name="l00059"></a><a class="code" href="classagg_1_1conv__curve.html">00059</a>              <font class="keyword">class </font>Curve4_Iterator=curve4&gt; <font class="keyword">class </font>conv_curve
00060     {
00061     <font class="keyword">public</font>:
<a name="l00062"></a><a class="code" href="classagg_1_1conv__curve.html#a0">00062</a>         <a class="code" href="classagg_1_1conv__curve.html#a0">conv_curve</a>(VertexSource* source) :
00063           <a class="code" href="classagg_1_1conv__curve.html#o0">m_source</a>(source), <a class="code" href="classagg_1_1conv__curve.html#o1">m_last_x</a>(0.0), <a class="code" href="classagg_1_1conv__curve.html#o2">m_last_y</a>(0.0) { }
00064 
00065         <font class="keywordtype">void</font> <a class="code" href="classagg_1_1conv__curve.html#a1">reset_iterator</a>(<font class="keywordtype">unsigned</font> start); 
00066         <a class="code" href="namespaceagg.html#a63">pathflag_e</a> <a class="code" href="classagg_1_1conv__curve.html#a2">next_vertex</a>(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y);
00067 
00068     <font class="keyword">private</font>:
<a name="l00069"></a><a class="code" href="classagg_1_1conv__curve.html#o0">00069</a>         VertexSource*   <a class="code" href="classagg_1_1conv__curve.html#o0">m_source</a>;
<a name="l00070"></a><a class="code" href="classagg_1_1conv__curve.html#o1">00070</a>         <font class="keywordtype">double</font>          <a class="code" href="classagg_1_1conv__curve.html#o1">m_last_x</a>;
<a name="l00071"></a><a class="code" href="classagg_1_1conv__curve.html#o2">00071</a>         <font class="keywordtype">double</font>          <a class="code" href="classagg_1_1conv__curve.html#o2">m_last_y</a>;
<a name="l00072"></a><a class="code" href="classagg_1_1conv__curve.html#o3">00072</a>         Curve3_Iterator <a class="code" href="classagg_1_1conv__curve.html#o3">m_curve3</a>;
<a name="l00073"></a><a class="code" href="classagg_1_1conv__curve.html#o4">00073</a>         Curve4_Iterator <a class="code" href="classagg_1_1conv__curve.html#o4">m_curve4</a>;
00074     };
00075 
00076 
00077 
00078     <font class="comment">//------------------------------------------------------------------------</font>
00079     <font class="keyword">template</font>&lt;<font class="keyword">class</font> VertexSource, <font class="keyword">class</font> Curve3_Iterator, <font class="keyword">class</font> Curve4_Iterator&gt;
<a name="l00080"></a><a class="code" href="classagg_1_1conv__curve.html#a1">00080</a>     <font class="keywordtype">void</font> conv_curve&lt;VertexSource, Curve3_Iterator, Curve4_Iterator&gt;::reset_iterator(<font class="keywordtype">unsigned</font> start)
00081     {
00082         <a class="code" href="classagg_1_1conv__curve.html#o0">m_source</a>-&gt;reset_iterator(start);
00083         <a class="code" href="classagg_1_1conv__curve.html#o1">m_last_x</a> = 0.0;
00084         <a class="code" href="classagg_1_1conv__curve.html#o2">m_last_y</a> = 0.0;
00085         <a class="code" href="classagg_1_1conv__curve.html#o3">m_curve3</a>.reset();
00086         <a class="code" href="classagg_1_1conv__curve.html#o4">m_curve4</a>.reset();
00087     }
00088 
00089 
00090 
00091     <font class="comment">//------------------------------------------------------------------------</font>
00092     <font class="keyword">template</font>&lt;<font class="keyword">class</font> VertexSource, <font class="keyword">class</font> Curve3_Iterator, <font class="keyword">class</font> Curve4_Iterator&gt;
00093     <a class="code" href="namespaceagg.html#a63">pathflag_e</a> conv_curve&lt;VertexSource, 
00094                           Curve3_Iterator, 
<a name="l00095"></a><a class="code" href="classagg_1_1conv__curve.html#a2">00095</a>                           Curve4_Iterator&gt;::next_vertex(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)
00096     {
00097         <font class="keywordflow">if</font>(m_curve3.next_vertex(x, y) != <a class="code" href="namespaceagg.html#a63a25">pathflag_stop</a>)
00098         {
00099             m_last_x = *x;
00100             m_last_y = *y;
00101             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00102         }
00103 
00104         <font class="keywordflow">if</font>(m_curve4.next_vertex(x, y) != <a class="code" href="namespaceagg.html#a63a25">pathflag_stop</a>)
00105         {
00106             m_last_x = *x;
00107             m_last_y = *y;
00108             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00109         }
00110 
00111         <font class="keywordtype">double</font> ct2_x;
00112         <font class="keywordtype">double</font> ct2_y;
00113         <font class="keywordtype">double</font> end_x;
00114         <font class="keywordtype">double</font> end_y;
00115 
00116         <a class="code" href="namespaceagg.html#a63">pathflag_e</a> flag = m_source-&gt;next_vertex(x, y);
00117         <font class="keywordflow">switch</font>(flag)
00118         {
00119         <font class="keywordflow">case</font> <a class="code" href="namespaceagg.html#a63a26">pathflag_move_to</a>:
00120         <font class="keywordflow">case</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>:
00121             m_last_x = *x;
00122             m_last_y = *y;
00123         <font class="keywordflow">default</font>:
00124             <font class="keywordflow">break</font>; 
00125         
00126         <font class="keywordflow">case</font> <a class="code" href="namespaceagg.html#a63a28">pathflag_curve3</a>:
00127             <font class="comment">// ATTN! add check for errors!</font>
00128             m_source-&gt;next_vertex(&amp;end_x, &amp;end_y);
00129 
00130             m_curve3.init(m_last_x, m_last_y, 
00131                           *x,       *y, 
00132                           end_x,     end_y);
00133 
00134             m_curve3.next_vertex(x, y);    <font class="comment">// First call returns pathflag_move_to</font>
00135             m_curve3.next_vertex(x, y);    <font class="comment">// This is the first vertex of the curve</font>
00136             flag = <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00137             <font class="keywordflow">break</font>;
00138 
00139         <font class="keywordflow">case</font> <a class="code" href="namespaceagg.html#a63a29">pathflag_curve4</a>:
00140             <font class="comment">// ATTN! add check for errors!</font>
00141             m_source-&gt;next_vertex(&amp;ct2_x, &amp;ct2_y);
00142             m_source-&gt;next_vertex(&amp;end_x, &amp;end_y);
00143 
00144             m_curve4.init(m_last_x, m_last_y, 
00145                           *x,       *y, 
00146                           ct2_x,    ct2_y, 
00147                           end_x,    end_y);
00148 
00149             m_curve4.next_vertex(x, y);    <font class="comment">// First call returns pathflag_move_to</font>
00150             m_curve4.next_vertex(x, y);    <font class="comment">// This is the first vertex of the curve</font>
00151             flag = <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00152             <font class="keywordflow">break</font>;
00153         }
00154         <font class="keywordflow">return</font> flag;
00155     }
00156 
00157 
00158 
00159 }
00160 
00161 
00162 
00163 <font class="preprocessor">#endif</font>
</pre></div><hr><address><small>Generated on Tue Apr 23 09:06:33 2002 for AGG v2.0 beta by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
