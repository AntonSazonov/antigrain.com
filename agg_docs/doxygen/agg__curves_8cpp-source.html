<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>agg_curves.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>agg_curves.cpp</h1><a href="agg__curves_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//----------------------------------------------------------------------------</font>
00002 <font class="comment">// Anti-Grain Geometry - Version 2.0 </font>
00003 <font class="comment">// Copyright (C) 2002 Maxim Shemanarev (McSeem)</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// Permission to copy, use, modify, sell and distribute this software </font>
00006 <font class="comment">// is granted provided this copyright notice appears in all copies. </font>
00007 <font class="comment">// This software is provided "as is" without express or implied</font>
00008 <font class="comment">// warranty, and with no claim as to its suitability for any purpose.</font>
00009 <font class="comment">//</font>
00010 <font class="comment">//----------------------------------------------------------------------------</font>
00011 <font class="comment">// Contact: mcseem@antigrain.com</font>
00012 <font class="comment">//          mcseemagg@yahoo.com</font>
00013 <font class="comment">//          http://www.antigrain.com</font>
00014 <font class="comment">//----------------------------------------------------------------------------</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// classes curve3 and curve4</font>
00017 <font class="comment">//</font>
00018 <font class="comment">//----------------------------------------------------------------------------</font>
00019 
00020 <font class="preprocessor">#include &lt;math.h&gt;</font>
00021 <font class="preprocessor">#include "<a class="code" href="agg__curves_8h.html">agg_curves.h</a>"</font>
00022 
00023 <font class="keyword">namespace </font>agg
00024 {
00025 
00026     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00027"></a><a class="code" href="classagg_1_1curve3.html#a2">00027</a>     <font class="keywordtype">void</font> curve3::init(<font class="keywordtype">double</font> x1, <font class="keywordtype">double</font> y1, 
00028                       <font class="keywordtype">double</font> x2, <font class="keywordtype">double</font> y2, 
00029                       <font class="keywordtype">double</font> x3, <font class="keywordtype">double</font> y3)
00030     {
00031         <a class="code" href="classagg_1_1curve3.html#o2">m_start_x</a> = x1;
00032         <a class="code" href="classagg_1_1curve3.html#o3">m_start_y</a> = y1;
00033         <a class="code" href="classagg_1_1curve3.html#o4">m_end_x</a>   = x3;
00034         <a class="code" href="classagg_1_1curve3.html#o5">m_end_y</a>   = y3;
00035 
00036         <font class="keywordtype">double</font> dx1 = x2 - x1;
00037         <font class="keywordtype">double</font> dy1 = y2 - y1;
00038         <font class="keywordtype">double</font> dx2 = x3 - x2;
00039         <font class="keywordtype">double</font> dy2 = y3 - y2;
00040 
00041         <font class="keywordtype">double</font> len = sqrt(dx1 * dx1 + dy1 * dy1) + sqrt(dx2 * dx2 + dy2 * dy2); 
00042 
00043         <a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a> = int(len * 0.5);
00044 
00045         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a> &lt; 2)
00046         {
00047             <a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a> = 2;   
00048         }
00049 
00050         <font class="comment">//if(num_steps &gt; max_num_steps) num_steps = max_num_steps; </font>
00051 
00052         <font class="keywordtype">double</font> subdivide_step  = 1.0 / (<a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a> + 1);
00053         <font class="keywordtype">double</font> subdivide_step2 = subdivide_step * subdivide_step;
00054 
00055         <font class="keywordtype">double</font> tmpx = (x1 - x2 * 2.0 + x3) * subdivide_step2;
00056         <font class="keywordtype">double</font> tmpy = (y1 - y2 * 2.0 + y3) * subdivide_step2;
00057 
00058         <a class="code" href="classagg_1_1curve3.html#o12">m_saved_fx</a> = <a class="code" href="classagg_1_1curve3.html#o6">m_fx</a> = x1;
00059         <a class="code" href="classagg_1_1curve3.html#o13">m_saved_fy</a> = <a class="code" href="classagg_1_1curve3.html#o7">m_fy</a> = y1;
00060         
00061         <a class="code" href="classagg_1_1curve3.html#o14">m_saved_dfx</a> = <a class="code" href="classagg_1_1curve3.html#o8">m_dfx</a> = tmpx + (x2 - x1) * (2.0 * subdivide_step);
00062         <a class="code" href="classagg_1_1curve3.html#o15">m_saved_dfy</a> = <a class="code" href="classagg_1_1curve3.html#o9">m_dfy</a> = tmpy + (y2 - y1) * (2.0 * subdivide_step);
00063 
00064         <a class="code" href="classagg_1_1curve3.html#o10">m_ddfx</a> = tmpx * 2.0;
00065         <a class="code" href="classagg_1_1curve3.html#o11">m_ddfy</a> = tmpy * 2.0;
00066 
00067         <a class="code" href="classagg_1_1curve3.html#o1">m_step</a> = <a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a>;
00068     }
00069 
00070 
00071 
00072 
00073     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00074"></a><a class="code" href="classagg_1_1curve3.html#a3">00074</a>     <font class="keywordtype">void</font> curve3::reset_iterator(<font class="keywordtype">unsigned</font>)
00075     {
00076         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a> == 0)
00077         {
00078             <a class="code" href="classagg_1_1curve3.html#o1">m_step</a> = -1;
00079             <font class="keywordflow">return</font>;
00080         }
00081         <a class="code" href="classagg_1_1curve3.html#o1">m_step</a> = <a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a>;
00082         <a class="code" href="classagg_1_1curve3.html#o6">m_fx</a>   = <a class="code" href="classagg_1_1curve3.html#o12">m_saved_fx</a>;
00083         <a class="code" href="classagg_1_1curve3.html#o7">m_fy</a>   = <a class="code" href="classagg_1_1curve3.html#o13">m_saved_fy</a>;
00084         <a class="code" href="classagg_1_1curve3.html#o8">m_dfx</a>  = <a class="code" href="classagg_1_1curve3.html#o14">m_saved_dfx</a>;
00085         <a class="code" href="classagg_1_1curve3.html#o9">m_dfy</a>  = <a class="code" href="classagg_1_1curve3.html#o15">m_saved_dfy</a>;
00086     }
00087 
00088 
00089 
00090 
00091     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00092"></a><a class="code" href="classagg_1_1curve3.html#a4">00092</a>     <a class="code" href="namespaceagg.html#a63">pathflag_e</a> curve3::next_vertex(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)
00093     {
00094         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve3.html#o1">m_step</a> &lt; 0) <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a25">pathflag_stop</a>;
00095         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve3.html#o1">m_step</a> == <a class="code" href="classagg_1_1curve3.html#o0">m_num_steps</a>)
00096         {
00097             *x = <a class="code" href="classagg_1_1curve3.html#o2">m_start_x</a>;
00098             *y = <a class="code" href="classagg_1_1curve3.html#o3">m_start_y</a>;
00099             --<a class="code" href="classagg_1_1curve3.html#o1">m_step</a>;
00100             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a26">pathflag_move_to</a>;
00101         }
00102         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve3.html#o1">m_step</a> == 0)
00103         {
00104             *x = <a class="code" href="classagg_1_1curve3.html#o4">m_end_x</a>;
00105             *y = <a class="code" href="classagg_1_1curve3.html#o5">m_end_y</a>;
00106             --<a class="code" href="classagg_1_1curve3.html#o1">m_step</a>;
00107             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00108         }
00109         <a class="code" href="classagg_1_1curve3.html#o6">m_fx</a>  += <a class="code" href="classagg_1_1curve3.html#o8">m_dfx</a>; 
00110         <a class="code" href="classagg_1_1curve3.html#o7">m_fy</a>  += <a class="code" href="classagg_1_1curve3.html#o9">m_dfy</a>;
00111         <a class="code" href="classagg_1_1curve3.html#o8">m_dfx</a> += <a class="code" href="classagg_1_1curve3.html#o10">m_ddfx</a>; 
00112         <a class="code" href="classagg_1_1curve3.html#o9">m_dfy</a> += <a class="code" href="classagg_1_1curve3.html#o11">m_ddfy</a>; 
00113         *x = <a class="code" href="classagg_1_1curve3.html#o6">m_fx</a>;
00114         *y = <a class="code" href="classagg_1_1curve3.html#o7">m_fy</a>;
00115         --<a class="code" href="classagg_1_1curve3.html#o1">m_step</a>;
00116         <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00117     }
00118 
00119 
00120 
00121 
00122 
00123 
00124 
00125 
00126 
00127 
00128 
00129 
00130 
00131     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00132"></a><a class="code" href="classagg_1_1curve4.html#a2">00132</a>     <font class="keywordtype">void</font> curve4::init(<font class="keywordtype">double</font> x1, <font class="keywordtype">double</font> y1, 
00133                       <font class="keywordtype">double</font> x2, <font class="keywordtype">double</font> y2, 
00134                       <font class="keywordtype">double</font> x3, <font class="keywordtype">double</font> y3,
00135                       <font class="keywordtype">double</font> x4, <font class="keywordtype">double</font> y4)
00136     {
00137         <a class="code" href="classagg_1_1curve4.html#o2">m_start_x</a> = x1;
00138         <a class="code" href="classagg_1_1curve4.html#o3">m_start_y</a> = y1;
00139         <a class="code" href="classagg_1_1curve4.html#o4">m_end_x</a>   = x4;
00140         <a class="code" href="classagg_1_1curve4.html#o5">m_end_y</a>   = y4;
00141 
00142         <font class="keywordtype">double</font> dx1 = x2 - x1;
00143         <font class="keywordtype">double</font> dy1 = y2 - y1;
00144         <font class="keywordtype">double</font> dx2 = x3 - x2;
00145         <font class="keywordtype">double</font> dy2 = y3 - y2;
00146         <font class="keywordtype">double</font> dx3 = x4 - x3;
00147         <font class="keywordtype">double</font> dy3 = y4 - y3;
00148 
00149         <font class="keywordtype">double</font> len = sqrt(dx1 * dx1 + dy1 * dy1) + 
00150                      sqrt(dx2 * dx2 + dy2 * dy2) + 
00151                      sqrt(dx3 * dx3 + dy3 * dy3);
00152 
00153         <a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a> = int(len * 0.5);
00154 
00155         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a> &lt; 2)
00156         {
00157             <a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a> = 2;   
00158         }
00159 
00160         <font class="comment">//if(num_steps &gt; max_num_steps) num_steps = max_num_steps; </font>
00161 
00162         <font class="keywordtype">double</font> subdivide_step  = 1.0 / (<a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a> + 1);
00163         <font class="keywordtype">double</font> subdivide_step2 = subdivide_step * subdivide_step;
00164         <font class="keywordtype">double</font> subdivide_step3 = subdivide_step * subdivide_step * subdivide_step;
00165 
00166 
00167             <font class="keywordtype">double</font> pre1 = 3.0 * subdivide_step;
00168             <font class="keywordtype">double</font> pre2 = 3.0 * subdivide_step2;
00169             <font class="keywordtype">double</font> pre4 = 6.0 * subdivide_step2;
00170             <font class="keywordtype">double</font> pre5 = 6.0 * subdivide_step3;
00171         
00172         <font class="keywordtype">double</font> tmp1x = x1 - x2 * 2.0 + x3;
00173         <font class="keywordtype">double</font> tmp1y = y1 - y2 * 2.0 + y3;
00174 
00175         <font class="keywordtype">double</font> tmp2x = (x2 - x3) * 3.0 - x1 + x4;
00176         <font class="keywordtype">double</font> tmp2y = (y2 - y3) * 3.0 - y1 + y4;
00177 
00178         <a class="code" href="classagg_1_1curve4.html#o14">m_saved_fx</a> = <a class="code" href="classagg_1_1curve4.html#o6">m_fx</a> = x1;
00179         <a class="code" href="classagg_1_1curve4.html#o15">m_saved_fy</a> = <a class="code" href="classagg_1_1curve4.html#o7">m_fy</a> = y1;
00180 
00181         <a class="code" href="classagg_1_1curve4.html#o16">m_saved_dfx</a> = <a class="code" href="classagg_1_1curve4.html#o8">m_dfx</a> = (x2 - x1) * pre1 + tmp1x * pre2 + tmp2x * subdivide_step3;
00182         <a class="code" href="classagg_1_1curve4.html#o17">m_saved_dfy</a> = <a class="code" href="classagg_1_1curve4.html#o9">m_dfy</a> = (y2 - y1) * pre1 + tmp1y * pre2 + tmp2y * subdivide_step3;
00183 
00184         <a class="code" href="classagg_1_1curve4.html#o18">m_saved_ddfx</a> = <a class="code" href="classagg_1_1curve4.html#o10">m_ddfx</a> = tmp1x * pre4 + tmp2x * pre5;
00185         <a class="code" href="classagg_1_1curve4.html#o19">m_saved_ddfy</a> = <a class="code" href="classagg_1_1curve4.html#o11">m_ddfy</a> = tmp1y * pre4 + tmp2y * pre5;
00186 
00187         <a class="code" href="classagg_1_1curve4.html#o12">m_dddfx</a> = tmp2x * pre5;
00188         <a class="code" href="classagg_1_1curve4.html#o13">m_dddfy</a> = tmp2y * pre5;
00189 
00190         <a class="code" href="classagg_1_1curve4.html#o1">m_step</a> = <a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a>;
00191     }
00192 
00193 
00194 
00195 
00196     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00197"></a><a class="code" href="classagg_1_1curve4.html#a3">00197</a>     <font class="keywordtype">void</font> curve4::reset_iterator(<font class="keywordtype">unsigned</font>)
00198     {
00199         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a> == 0)
00200         {
00201             <a class="code" href="classagg_1_1curve4.html#o1">m_step</a> = -1;
00202             <font class="keywordflow">return</font>;
00203         }
00204         <a class="code" href="classagg_1_1curve4.html#o1">m_step</a> = <a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a>;
00205         <a class="code" href="classagg_1_1curve4.html#o6">m_fx</a>   = <a class="code" href="classagg_1_1curve4.html#o14">m_saved_fx</a>;
00206         <a class="code" href="classagg_1_1curve4.html#o7">m_fy</a>   = <a class="code" href="classagg_1_1curve4.html#o15">m_saved_fy</a>;
00207         <a class="code" href="classagg_1_1curve4.html#o8">m_dfx</a>  = <a class="code" href="classagg_1_1curve4.html#o16">m_saved_dfx</a>;
00208         <a class="code" href="classagg_1_1curve4.html#o9">m_dfy</a>  = <a class="code" href="classagg_1_1curve4.html#o17">m_saved_dfy</a>;
00209         <a class="code" href="classagg_1_1curve4.html#o10">m_ddfx</a> = <a class="code" href="classagg_1_1curve4.html#o18">m_saved_ddfx</a>;
00210         <a class="code" href="classagg_1_1curve4.html#o11">m_ddfy</a> = <a class="code" href="classagg_1_1curve4.html#o19">m_saved_ddfy</a>;
00211     }
00212 
00213 
00214 
00215 
00216 
00217     <font class="comment">//------------------------------------------------------------------------</font>
<a name="l00218"></a><a class="code" href="classagg_1_1curve4.html#a4">00218</a>     <a class="code" href="namespaceagg.html#a63">pathflag_e</a> curve4::next_vertex(<font class="keywordtype">double</font>* x, <font class="keywordtype">double</font>* y)
00219     {
00220         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve4.html#o1">m_step</a> &lt; 0) <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a25">pathflag_stop</a>;
00221         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve4.html#o1">m_step</a> == <a class="code" href="classagg_1_1curve4.html#o0">m_num_steps</a>)
00222         {
00223             *x = <a class="code" href="classagg_1_1curve4.html#o2">m_start_x</a>;
00224             *y = <a class="code" href="classagg_1_1curve4.html#o3">m_start_y</a>;
00225             --<a class="code" href="classagg_1_1curve4.html#o1">m_step</a>;
00226             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a26">pathflag_move_to</a>;
00227         }
00228         <font class="keywordflow">if</font>(<a class="code" href="classagg_1_1curve4.html#o1">m_step</a> == 0)
00229         {
00230             *x = <a class="code" href="classagg_1_1curve4.html#o4">m_end_x</a>;
00231             *y = <a class="code" href="classagg_1_1curve4.html#o5">m_end_y</a>;
00232             --<a class="code" href="classagg_1_1curve4.html#o1">m_step</a>;
00233             <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00234         }
00235         <a class="code" href="classagg_1_1curve4.html#o6">m_fx</a>   += <a class="code" href="classagg_1_1curve4.html#o8">m_dfx</a>; 
00236         <a class="code" href="classagg_1_1curve4.html#o7">m_fy</a>   += <a class="code" href="classagg_1_1curve4.html#o9">m_dfy</a>;
00237         <a class="code" href="classagg_1_1curve4.html#o8">m_dfx</a>  += <a class="code" href="classagg_1_1curve4.html#o10">m_ddfx</a>; 
00238         <a class="code" href="classagg_1_1curve4.html#o9">m_dfy</a>  += <a class="code" href="classagg_1_1curve4.html#o11">m_ddfy</a>; 
00239         <a class="code" href="classagg_1_1curve4.html#o10">m_ddfx</a> += <a class="code" href="classagg_1_1curve4.html#o12">m_dddfx</a>; 
00240         <a class="code" href="classagg_1_1curve4.html#o11">m_ddfy</a> += <a class="code" href="classagg_1_1curve4.html#o13">m_dddfy</a>; 
00241         *x = <a class="code" href="classagg_1_1curve4.html#o6">m_fx</a>;
00242         *y = <a class="code" href="classagg_1_1curve4.html#o7">m_fy</a>;
00243         --<a class="code" href="classagg_1_1curve4.html#o1">m_step</a>;
00244         <font class="keywordflow">return</font> <a class="code" href="namespaceagg.html#a63a27">pathflag_line_to</a>;
00245     }
00246 
00247 
00248 
00249 
00250 }
00251 
</pre></div><hr><address><small>Generated on Tue Apr 23 09:06:33 2002 for AGG v2.0 beta by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
